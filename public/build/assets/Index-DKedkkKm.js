import{d as Q,r as m,c as j,o as X,a as c,b as f,e as a,u as V,m as Y,w as l,f as r,g as q,h as P,C as Z,i as o,F as h,j as A,t as g,A as ee,k as B,W as te}from"./app-Py-KhCof.js";import{C as ae,_ as se}from"./AppLayout.vue_vue_type_script_setup_true_lang-BxOgdMMd.js";import{u as le}from"./InvestorStore-B58BPw1g.js";import{_ as d}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-Dn4fNI4e.js";import{_ as y}from"./Input.vue_vue_type_script_setup_true_lang--G0Q0eTO.js";import{_ as $,a as D,b as U,c as S}from"./DialogTitle.vue_vue_type_script_setup_true_lang-xkXlj1WN.js";import{_ as N}from"./DialogTrigger.vue_vue_type_script_setup_true_lang-CLfJ7BCe.js";import{_ as z}from"./DialogFooter.vue_vue_type_script_setup_true_lang-zzOAfG-b.js";import{S as x}from"./sweetalert2.esm.all-odB5D8k1.js";import"./useForwardExpose-N3V696vC.js";import"./RovingFocusGroup-Cd9WNB1g.js";const re={class:"flex flex-col gap-4 p-4"},oe={class:"flex items-center justify-between gap-2"},ne={class:"flex gap-2 items-center"},ie={class:"overflow-x-auto rounded-xl border border-sidebar-border/70 dark:border-sidebar-border bg-white dark:bg-gray-900"},de={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},ue={class:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700"},pe={key:0,class:"animate-pulse"},fe={key:1},ve={class:"px-6 py-4 whitespace-nowrap"},me={class:"px-6 py-4 whitespace-nowrap"},ce={class:"px-6 py-4 whitespace-nowrap"},ge={class:"px-6 py-4 whitespace-nowrap text-right"},ye={class:"flex gap-1"},xe={key:0,class:"flex items-center justify-between px-4 py-3 bg-white dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700"},_e={class:"flex items-center text-sm text-gray-700 dark:text-gray-300"},be={class:"flex items-center space-x-2"},we={class:"flex items-center space-x-1"},Fe=Q({__name:"Index",setup(ke){const M=[{title:"Dashboard",href:"/dashboard"},{title:"Investors",href:"/investors"}],n=le(),C=m(""),_=m(!1),b=m(!1),k=m(null),w=m(!1),i=m(null),v=m({name:"",address:"",phone:""}),E=j(()=>{const s=n.investors;return(s==null?void 0:s.data)||[]}),u=j(()=>{const s=n.investors;return s!=null&&s.current_page?{current_page:s.current_page,last_page:s.last_page,per_page:s.per_page,total:s.total,from:s.from,to:s.to}:null});function F(){n.setFilters({search:C.value,page:1}),n.fetchInvestors()}function I(s){n.setFilters({...n.filters,page:s}),n.fetchInvestors()}function T(){if(!u.value)return[];const s=u.value.current_page,e=u.value.last_page,t=[];t.push(1);for(let p=Math.max(2,s-1);p<=Math.min(e-1,s+1);p++)p>1&&p<e&&t.push(p);return e>1&&t.push(e),[...new Set(t)].sort((p,O)=>p-O)}function K(){v.value={name:"",address:"",phone:""},_.value=!0}async function L(){try{await n.createInvestor(v.value),await n.fetchInvestors(),_.value=!1,x.fire({icon:"success",title:"Investor created successfully!"})}catch(s){x.fire({icon:"error",title:"Error",text:(s==null?void 0:s.message)||"Failed to create investor."})}}function R(s){k.value=s,b.value=!0}async function W(){if(k.value!==null)try{await n.deleteInvestor(k.value),await n.fetchInvestors(),b.value=!1,k.value=null,x.fire({icon:"success",title:"Investor deleted successfully!"})}catch(s){x.fire({icon:"error",title:"Error",text:(s==null?void 0:s.message)||"Failed to delete investor."})}}function H(s){i.value={...s},w.value=!0}function G(s){te.visit(`/investors/${s}/report`)}async function J(){if(i.value&&i.value.id)try{await n.updateInvestor(i.value.id,{name:i.value.name,address:i.value.address,phone:i.value.phone}),await n.fetchInvestors(),w.value=!1,i.value=null,x.fire({icon:"success",title:"Investor updated successfully!"})}catch(s){x.fire({icon:"error",title:"Error",text:(s==null?void 0:s.message)||"Failed to update investor."})}}return X(()=>{n.fetchInvestors()}),(s,e)=>(f(),c(h,null,[a(V(Y),{title:"Investors"}),a(se,{breadcrumbs:M},{default:l(()=>[r("div",re,[r("div",oe,[r("div",ne,[a(y,{modelValue:C.value,"onUpdate:modelValue":e[0]||(e[0]=t=>C.value=t),placeholder:"Search investors...",onKeyup:Z(F,["enter"]),class:"w-64"},null,8,["modelValue"]),a(d,{onClick:F,variant:"default"},{default:l(()=>e[15]||(e[15]=[o("Search")])),_:1})]),a(d,{onClick:K,variant:"secondary"},{default:l(()=>e[16]||(e[16]=[o("Create Investor")])),_:1})]),r("div",ie,[r("table",de,[e[21]||(e[21]=r("thead",{class:"bg-gray-50 dark:bg-gray-800"},[r("tr",null,[r("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Name"),r("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Address"),r("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Phone"),r("th",{class:"px-6 py-3"})])],-1)),r("tbody",ue,[V(n).loading?(f(),c("tr",pe,e[17]||(e[17]=[r("td",{colspan:"4",class:"px-6 py-4 text-center text-gray-500"},"Loading...",-1)]))):E.value.length===0?(f(),c("tr",fe,e[18]||(e[18]=[r("td",{colspan:"4",class:"px-6 py-4 text-center text-gray-500"},"No investors found.",-1)]))):(f(!0),c(h,{key:2},A(E.value,t=>(f(),c("tr",{key:t.id},[r("td",ve,g(t.name),1),r("td",me,g(t.address),1),r("td",ce,g(t.phone),1),r("td",ge,[r("div",ye,[a(d,{variant:"default",size:"sm",onClick:p=>G(t.id),title:"View Report",class:"w-8 h-8 p-0"},{default:l(()=>[a(V(ae),{size:16})]),_:2},1032,["onClick"]),a(d,{variant:"secondary",size:"sm",onClick:p=>H(t),title:"Update",class:"w-8 h-8 p-0"},{default:l(()=>e[19]||(e[19]=[o(" âœï¸ ")])),_:2},1032,["onClick"]),a(d,{variant:"destructive",size:"sm",onClick:p=>R(t.id),title:"Delete",class:"w-8 h-8 p-0"},{default:l(()=>e[20]||(e[20]=[o(" ðŸ—‘ï¸ ")])),_:2},1032,["onClick"])])])]))),128))])])]),u.value?(f(),c("div",xe,[r("div",_e,[r("span",null,"Showing "+g(u.value.from)+" to "+g(u.value.to)+" of "+g(u.value.total)+" results",1)]),r("div",be,[a(d,{variant:"outline",size:"sm",disabled:u.value.current_page===1,onClick:e[1]||(e[1]=t=>I(u.value.current_page-1))},{default:l(()=>e[22]||(e[22]=[o(" Previous ")])),_:1},8,["disabled"]),r("div",we,[(f(!0),c(h,null,A(T(),t=>(f(),q(d,{key:t,variant:"outline",size:"sm",class:ee(t===u.value.current_page?"bg-primary text-primary-foreground":""),onClick:p=>I(t)},{default:l(()=>[o(g(t),1)]),_:2},1032,["class","onClick"]))),128))]),a(d,{variant:"outline",size:"sm",disabled:u.value.current_page===u.value.last_page,onClick:e[2]||(e[2]=t=>I(u.value.current_page+1))},{default:l(()=>e[23]||(e[23]=[o(" Next ")])),_:1},8,["disabled"])])])):P("",!0)]),a($,{open:_.value,"onUpdate:open":e[7]||(e[7]=t=>_.value=t)},{default:l(()=>[a(N,{"as-child":""}),a(D,null,{default:l(()=>[a(U,null,{default:l(()=>[a(S,null,{default:l(()=>e[24]||(e[24]=[o("Create Investor")])),_:1})]),_:1}),r("form",{onSubmit:B(L,["prevent"]),class:"flex flex-col gap-4 mt-2"},[a(y,{modelValue:v.value.name,"onUpdate:modelValue":e[3]||(e[3]=t=>v.value.name=t),placeholder:"Name",required:""},null,8,["modelValue"]),a(y,{modelValue:v.value.address,"onUpdate:modelValue":e[4]||(e[4]=t=>v.value.address=t),placeholder:"Address",required:""},null,8,["modelValue"]),a(y,{modelValue:v.value.phone,"onUpdate:modelValue":e[5]||(e[5]=t=>v.value.phone=t),placeholder:"Phone",required:""},null,8,["modelValue"]),a(z,{class:"flex justify-end gap-2 mt-4"},{default:l(()=>[a(d,{type:"button",variant:"secondary",onClick:e[6]||(e[6]=t=>_.value=!1)},{default:l(()=>e[25]||(e[25]=[o("Cancel")])),_:1}),a(d,{type:"submit",variant:"default"},{default:l(()=>e[26]||(e[26]=[o("Create")])),_:1})]),_:1})],32)]),_:1})]),_:1},8,["open"]),a($,{open:b.value,"onUpdate:open":e[9]||(e[9]=t=>b.value=t)},{default:l(()=>[a(N,{"as-child":""}),a(D,null,{default:l(()=>[a(U,null,{default:l(()=>[a(S,null,{default:l(()=>e[27]||(e[27]=[o("Delete Investor")])),_:1})]),_:1}),e[30]||(e[30]=r("div",{class:"mt-2"},"Are you sure you want to delete this investor?",-1)),a(z,{class:"flex justify-end gap-2 mt-4"},{default:l(()=>[a(d,{type:"button",variant:"secondary",onClick:e[8]||(e[8]=t=>b.value=!1)},{default:l(()=>e[28]||(e[28]=[o("Cancel")])),_:1}),a(d,{type:"button",variant:"destructive",onClick:W},{default:l(()=>e[29]||(e[29]=[o("Delete")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),i.value?(f(),q($,{key:0,open:w.value,"onUpdate:open":e[14]||(e[14]=t=>w.value=t)},{default:l(()=>[a(N,{"as-child":""}),a(D,null,{default:l(()=>[a(U,null,{default:l(()=>[a(S,null,{default:l(()=>e[31]||(e[31]=[o("Edit Investor")])),_:1})]),_:1}),r("form",{onSubmit:B(J,["prevent"]),class:"flex flex-col gap-4 mt-2"},[a(y,{modelValue:i.value.name,"onUpdate:modelValue":e[10]||(e[10]=t=>i.value.name=t),placeholder:"Name",required:""},null,8,["modelValue"]),a(y,{modelValue:i.value.address,"onUpdate:modelValue":e[11]||(e[11]=t=>i.value.address=t),placeholder:"Address",required:""},null,8,["modelValue"]),a(y,{modelValue:i.value.phone,"onUpdate:modelValue":e[12]||(e[12]=t=>i.value.phone=t),placeholder:"Phone",required:""},null,8,["modelValue"]),a(z,{class:"flex justify-end gap-2 mt-4"},{default:l(()=>[a(d,{type:"button",variant:"secondary",onClick:e[13]||(e[13]=t=>w.value=!1)},{default:l(()=>e[32]||(e[32]=[o("Cancel")])),_:1}),a(d,{type:"submit",variant:"default"},{default:l(()=>e[33]||(e[33]=[o("Update")])),_:1})]),_:1})],32)]),_:1})]),_:1},8,["open"])):P("",!0)]),_:1})],64))}});export{Fe as default};

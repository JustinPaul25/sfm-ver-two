import{d as z,r as m,c as F,g as h,b as u,w as n,f as e,e as a,h as x,u as l,i as r,t as i,a as c,F as b,j as y,p as q,W as H}from"./app-CBk11mag.js";import{_ as M}from"./AppLayout.vue_vue_type_script_setup_true_lang-D12r0hmV.js";import{_ as k}from"./Card.vue_vue_type_script_setup_true_lang-F4Smfpbq.js";import{_ as S,a as C,b as $}from"./CardTitle.vue_vue_type_script_setup_true_lang-g9lBRGOY.js";import{_}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-Dq1VqWqp.js";import{_ as W}from"./Checkbox.vue_vue_type_script_setup_true_lang-D4l0MeXR.js";import{_ as R,a as J,b as K,c as P,d as Q}from"./DialogTitle.vue_vue_type_script_setup_true_lang-S02Kz3jF.js";import{_ as X}from"./DialogDescription.vue_vue_type_script_setup_true_lang-dxgv6blY.js";import{_ as Y}from"./DialogTrigger.vue_vue_type_script_setup_true_lang-6aYthWHk.js";import"./useForwardExpose-DBlRa9Z3.js";import"./RovingFocusGroup-2FDYX2yh.js";const Z={class:"space-y-6"},I={class:"flex items-center justify-between"},ee={class:"space-y-4"},te={class:"font-medium mb-2"},se={class:"max-h-32 overflow-y-auto space-y-1"},le={class:"flex items-center space-x-2"},ne={class:"flex gap-2"},ae={class:"text-sm text-muted-foreground"},ie={class:"space-y-3"},oe={class:"flex items-center space-x-3"},ue={class:"font-medium"},de={class:"text-sm text-muted-foreground"},re={class:"text-sm text-muted-foreground"},ce={class:"space-y-3"},fe={class:"flex items-center space-x-3"},me={class:"font-medium"},_e={class:"text-sm text-muted-foreground"},ge={class:"text-sm text-muted-foreground"},ve={class:"text-right"},pe={class:"text-sm text-muted-foreground"},he={class:"text-sm text-muted-foreground"},xe={class:"space-y-2"},be={class:"text-green-700"},ye={key:0,class:"mt-3"},ke={class:"text-sm text-red-600 space-y-1"},Be=z({__name:"FeedingSchedules",props:{cages:{}},setup(B){const w=B,d=m([]),g=m(!1),A=m(!1),v=m(!1),f=m(null),p=F(()=>w.cages.filter(o=>!o.has_schedule)),G=F(()=>w.cages.filter(o=>o.has_schedule)),N=F(()=>d.value.length>0),T=()=>{d.value=p.value.map(o=>o.id)},D=()=>{d.value=[]},U=o=>{const t=d.value.indexOf(o);t>-1?d.value.splice(t,1):d.value.push(o)},j=o=>d.value.includes(o),V=async()=>{var o,t;if(N.value){v.value=!0;try{const s=await q.post("/cages/feeding-schedules/auto-generate",{cage_ids:d.value,overwrite_existing:A.value});f.value=s.data,setTimeout(()=>{H.reload()},2e3)}catch(s){console.error("Auto-generation failed:",s),alert("Failed to auto-generate schedules: "+(((t=(o=s.response)==null?void 0:o.data)==null?void 0:t.message)||s.message))}finally{v.value=!1,g.value=!1}}},E=o=>o?new Date(`2000-01-01T${o}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"No schedule",L=o=>`${o.toFixed(2)} kg`;return(o,t)=>(u(),h(M,null,{default:n(()=>[e("div",Z,[e("div",I,[t[9]||(t[9]=e("div",null,[e("h1",{class:"text-3xl font-bold"},"Feeding Schedules"),e("p",{class:"text-muted-foreground"}," Manage feeding schedules for all cages ")],-1)),a(l(R),{open:g.value,"onUpdate:open":t[2]||(t[2]=s=>g.value=s)},{default:n(()=>[a(l(Y),{"as-child":""},{default:n(()=>[a(l(_),{disabled:!N.value,class:"bg-blue-600 hover:bg-blue-700"},{default:n(()=>t[3]||(t[3]=[r(" ðŸš€ Auto-Generate Schedules ")])),_:1},8,["disabled"])]),_:1}),a(l(J),{class:"sm:max-w-md"},{default:n(()=>[a(l(K),null,{default:n(()=>[a(l(P),null,{default:n(()=>t[4]||(t[4]=[r("Auto-Generate Feeding Schedules")])),_:1}),a(l(X),null,{default:n(()=>t[5]||(t[5]=[r(" Generate intelligent feeding schedules based on cage characteristics, fish age, and fingerling count. ")])),_:1})]),_:1}),e("div",ee,[e("div",null,[e("h4",te,"Selected Cages: "+i(d.value.length),1),e("div",se,[(u(!0),c(b,null,y(w.cages.filter(s=>d.value.includes(s.id)),s=>(u(),c("div",{key:s.id,class:"text-sm p-2 bg-gray-50 rounded"}," Cage "+i(s.id)+" - "+i(s.investor_name)+" ("+i(s.number_of_fingerlings)+" fingerlings) ",1))),128))])]),e("div",le,[a(l(W),{id:"overwrite",checked:A.value,"onUpdate:checked":t[0]||(t[0]=s=>A.value=s)},null,8,["checked"]),t[6]||(t[6]=e("label",{for:"overwrite",class:"text-sm"}," Overwrite existing schedules ",-1))]),t[7]||(t[7]=e("div",{class:"bg-blue-50 p-3 rounded-lg"},[e("h5",{class:"font-medium text-blue-900 mb-1"},"Auto-Generation Logic:"),e("ul",{class:"text-sm text-blue-800 space-y-1"},[e("li",null,"â€¢ Fish age calculated from latest sampling"),e("li",null,"â€¢ Feeding frequency based on fish age"),e("li",null,"â€¢ Amount calculated per fingerling"),e("li",null,"â€¢ Optimal feeding times distributed")])],-1))]),a(l(Q),null,{default:n(()=>[a(l(_),{variant:"outline",onClick:t[1]||(t[1]=s=>g.value=!1)},{default:n(()=>t[8]||(t[8]=[r(" Cancel ")])),_:1}),a(l(_),{onClick:V,disabled:v.value,class:"bg-blue-600 hover:bg-blue-700"},{default:n(()=>[r(i(v.value?"Generating...":"Generate Schedules"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),a(l(k),null,{default:n(()=>[a(l(S),null,{default:n(()=>[a(l(C),{class:"flex items-center justify-between"},{default:n(()=>[t[12]||(t[12]=e("span",null,"Bulk Selection",-1)),e("div",ne,[a(l(_),{variant:"outline",size:"sm",onClick:T},{default:n(()=>t[10]||(t[10]=[r(" Select All Without Schedules ")])),_:1}),a(l(_),{variant:"outline",size:"sm",onClick:D},{default:n(()=>t[11]||(t[11]=[r(" Clear Selection ")])),_:1})])]),_:1})]),_:1}),a(l($),null,{default:n(()=>[e("div",ae," Selected: "+i(d.value.length)+" cages ",1)]),_:1})]),_:1}),p.value.length>0?(u(),h(l(k),{key:0},{default:n(()=>[a(l(S),null,{default:n(()=>[a(l(C),{class:"text-orange-600"},{default:n(()=>[r(" Cages Without Schedules ("+i(p.value.length)+") ",1)]),_:1})]),_:1}),a(l($),null,{default:n(()=>[e("div",ie,[(u(!0),c(b,null,y(p.value,s=>(u(),c("div",{key:s.id,class:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50"},[e("div",oe,[a(l(W),{checked:j(s.id),"onUpdate:checked":O=>U(s.id)},null,8,["checked","onUpdate:checked"]),e("div",null,[e("h4",ue,"Cage "+i(s.id),1),e("p",de,i(s.investor_name)+" â€¢ "+i(s.feed_type),1),e("p",re,i(s.number_of_fingerlings)+" fingerlings ",1)])]),t[13]||(t[13]=e("div",{class:"text-right"},[e("span",{class:"text-orange-600 font-medium"},"No Schedule")],-1))]))),128))])]),_:1})]),_:1})):x("",!0),G.value.length>0?(u(),h(l(k),{key:1},{default:n(()=>[a(l(S),null,{default:n(()=>[a(l(C),{class:"text-green-600"},{default:n(()=>[r(" Cages With Schedules ("+i(G.value.length)+") ",1)]),_:1})]),_:1}),a(l($),null,{default:n(()=>[e("div",ce,[(u(!0),c(b,null,y(G.value,s=>(u(),c("div",{key:s.id,class:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50"},[e("div",fe,[a(l(W),{checked:j(s.id),"onUpdate:checked":O=>U(s.id)},null,8,["checked","onUpdate:checked"]),e("div",null,[e("h4",me,"Cage "+i(s.id),1),e("p",_e,i(s.investor_name)+" â€¢ "+i(s.feed_type),1),e("p",ge,i(s.number_of_fingerlings)+" fingerlings ",1)])]),e("div",ve,[t[14]||(t[14]=e("div",{class:"text-green-600 font-medium"},"Has Schedule",-1)),e("div",pe," Next: "+i(E(s.next_feeding)),1),e("div",he," Daily: "+i(L(s.total_daily_amount)),1)])]))),128))])]),_:1})]),_:1})):x("",!0),f.value?(u(),h(l(k),{key:2,class:"bg-green-50 border-green-200"},{default:n(()=>[a(l(S),null,{default:n(()=>[a(l(C),{class:"text-green-800"},{default:n(()=>t[15]||(t[15]=[r(" âœ… Auto-Generation Complete ")])),_:1})]),_:1}),a(l($),null,{default:n(()=>[e("div",xe,[e("p",be,i(f.value.message),1),f.value.errors.length>0?(u(),c("div",ye,[t[16]||(t[16]=e("h5",{class:"font-medium text-red-700 mb-1"},"Errors:",-1)),e("ul",ke,[(u(!0),c(b,null,y(f.value.errors,s=>(u(),c("li",{key:s},i(s),1))),128))])])):x("",!0)])]),_:1})]),_:1})):x("",!0)])]),_:1}))}});export{Be as default};

import{d as K,r as f,c as A,o as Q,a as V,b as k,e as a,u as $,m as X,w as o,f as t,g as Y,h as N,t as d,P as Z,i as n,F as U,j as ee,W as x}from"./app-Ce6-Ko34.js";import{_ as te}from"./AppLayout.vue_vue_type_script_setup_true_lang-DqDg9dOe.js";import{_ as g}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CPp0Lkx-.js";import{_ as S}from"./Card.vue_vue_type_script_setup_true_lang-Ds_rI1QS.js";import{_ as O,a as j,b as T}from"./CardTitle.vue_vue_type_script_setup_true_lang-B1jjd4U_.js";import{_}from"./Input.vue_vue_type_script_setup_true_lang-CHwePdod.js";import{_ as i}from"./Label.vue_vue_type_script_setup_true_lang-D_LTZJ-v.js";import{_ as B,a as I,b as M,c as z,d as L}from"./DialogTitle.vue_vue_type_script_setup_true_lang-CvRFGcOW.js";import"./useForwardExpose-RCeQWXU4.js";import"./RovingFocusGroup-Cx0dFY1W.js";const ae={class:"max-w-6xl mx-auto p-6 space-y-6"},oe={class:"flex items-center justify-between"},le={class:"text-3xl font-bold"},ne={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},se={class:"text-2xl font-bold text-primary"},de={class:"text-lg"},ue={class:"text-lg"},re={class:"flex items-center justify-between"},ie={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},me={class:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg"},pe={class:"text-2xl font-bold text-blue-700 dark:text-blue-300"},fe={class:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg"},ge={class:"text-2xl font-bold text-green-700 dark:text-green-300"},ve={class:"p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg"},_e={class:"text-2xl font-bold text-purple-700 dark:text-purple-300"},xe={class:"overflow-x-auto"},ce={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},ye={class:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700"},be={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},ke={class:"px-6 py-4 whitespace-nowrap text-sm"},Ce={class:"px-6 py-4 whitespace-nowrap text-sm"},we={class:"px-6 py-4 text-sm"},Ve={class:"px-6 py-4 whitespace-nowrap text-sm"},$e={class:"flex space-x-2"},Fe={key:0},Ee={class:"space-y-4"},De={class:"space-y-4"},ze=K({__name:"View",props:{cage:{},feedConsumptions:{},errors:{},flash:{}},setup(P){const F=P,v=F.cage.id,W=[{title:"Dashboard",href:"/dashboard"},{title:"Cages",href:"/cages"},{title:`View Cage #${v}`,href:`/cages/${v}/view`}],C=f(F.cage),m=f(F.feedConsumptions),c=f(!1),y=f(!1),b=f(null),u=f(!1),r=f({day_number:1,feed_amount:"",consumption_date:new Date().toISOString().split("T")[0],notes:""}),p=f({feed_amount:"",consumption_date:"",notes:""}),E=A(()=>m.value.reduce((s,e)=>s+parseFloat(e.feed_amount||"0"),0)),R=A(()=>m.value.length===0?0:E.value/m.value.length),h=async()=>{u.value=!0;try{await x.post(`/cages/${v}/feed-consumptions`,r.value,{onSuccess:()=>{c.value=!1,J(),x.reload()},onError:s=>{const e=s.message||Object.values(s)[0]||"Error adding feed consumption";alert(e)},onFinish:()=>{u.value=!1}})}catch(s){console.error("Error adding feed consumption:",s),alert("Error adding feed consumption"),u.value=!1}},q=async()=>{if(b.value){u.value=!0;try{await x.put(`/cages/${v}/feed-consumptions/${b.value.id}`,p.value,{onSuccess:()=>{y.value=!1,b.value=null,x.reload()},onError:s=>{const e=s.message||Object.values(s)[0]||"Error updating feed consumption";alert(e)},onFinish:()=>{u.value=!1}})}catch(s){console.error("Error updating feed consumption:",s),alert("Error updating feed consumption"),u.value=!1}}},G=async s=>{if(confirm("Are you sure you want to delete this feed consumption record?"))try{await x.delete(`/cages/${v}/feed-consumptions/${s.id}`,{onSuccess:()=>{x.reload()},onError:e=>{const l=e.message||Object.values(e)[0]||"Error deleting feed consumption";alert(l)}})}catch(e){console.error("Error deleting feed consumption:",e),alert("Error deleting feed consumption")}},H=s=>{b.value=s,p.value={feed_amount:s.feed_amount,consumption_date:s.consumption_date,notes:s.notes||""},y.value=!0},J=()=>{const s=m.value.length>0?Math.max(...m.value.map(e=>e.day_number)):0;r.value={day_number:s+1,feed_amount:"",consumption_date:new Date().toISOString().split("T")[0],notes:""}};return Q(()=>{}),(s,e)=>(k(),V(U,null,[a($(X),{title:`View Cage #${$(v)}`},null,8,["title"]),a(te,{breadcrumbs:W},{default:o(()=>[t("div",ae,[t("div",oe,[t("h1",le,"Cage #"+d($(v)),1),a($(Z),{href:"/cages"},{default:o(()=>[a(g,{variant:"secondary"},{default:o(()=>e[12]||(e[12]=[n("Back to Cages")])),_:1})]),_:1})]),C.value?(k(),Y(S,{key:0},{default:o(()=>[a(O,null,{default:o(()=>[a(j,null,{default:o(()=>e[13]||(e[13]=[n("Cage Information")])),_:1})]),_:1}),a(T,null,{default:o(()=>{var l,w,D;return[t("div",ne,[t("div",null,[a(i,null,{default:o(()=>e[14]||(e[14]=[n("Number of Fingerlings")])),_:1}),t("p",se,d((l=C.value.number_of_fingerlings)==null?void 0:l.toLocaleString()),1)]),t("div",null,[a(i,null,{default:o(()=>e[15]||(e[15]=[n("Feed Type")])),_:1}),t("p",de,d((w=C.value.feed_type)==null?void 0:w.name),1)]),t("div",null,[a(i,null,{default:o(()=>e[16]||(e[16]=[n("Investor")])),_:1}),t("p",ue,d((D=C.value.investor)==null?void 0:D.name),1)])])]}),_:1})]),_:1})):N("",!0),a(S,null,{default:o(()=>[a(O,null,{default:o(()=>[t("div",re,[a(j,null,{default:o(()=>e[17]||(e[17]=[n("Daily Feed Consumption")])),_:1}),a(g,{onClick:e[0]||(e[0]=l=>c.value=!0)},{default:o(()=>e[18]||(e[18]=[n("Add Feed Consumption")])),_:1})])]),_:1}),a(T,null,{default:o(()=>[t("div",ie,[t("div",me,[e[19]||(e[19]=t("h3",{class:"text-sm font-medium text-blue-600 dark:text-blue-400"},"Total Days Recorded",-1)),t("p",pe,d(m.value.length),1)]),t("div",fe,[e[20]||(e[20]=t("h3",{class:"text-sm font-medium text-green-600 dark:text-green-400"},"Total Feed Consumed",-1)),t("p",ge,d(E.value.toFixed(2))+" kg",1)]),t("div",ve,[e[21]||(e[21]=t("h3",{class:"text-sm font-medium text-purple-600 dark:text-purple-400"},"Average Daily Feed",-1)),t("p",_e,d(R.value.toFixed(2))+" kg",1)])]),t("div",xe,[t("table",ce,[e[25]||(e[25]=t("thead",{class:"bg-gray-50 dark:bg-gray-800"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Day"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Date"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Feed Amount (kg)"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Notes"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Actions")])],-1)),t("tbody",ye,[(k(!0),V(U,null,ee(m.value,l=>(k(),V("tr",{key:l.id},[t("td",be,d(l.day_number),1),t("td",ke,d(l.consumption_date),1),t("td",Ce,d(l.feed_amount)+" kg",1),t("td",we,d(l.notes||"-"),1),t("td",Ve,[t("div",$e,[a(g,{variant:"outline",size:"sm",onClick:w=>H(l)},{default:o(()=>e[22]||(e[22]=[n("Edit")])),_:2},1032,["onClick"]),a(g,{variant:"destructive",size:"sm",onClick:w=>G(l)},{default:o(()=>e[23]||(e[23]=[n("Delete")])),_:2},1032,["onClick"])])])]))),128)),m.value.length===0?(k(),V("tr",Fe,e[24]||(e[24]=[t("td",{colspan:"5",class:"px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400"}," No feed consumption records found. Add the first record to get started. ",-1)]))):N("",!0)])])])]),_:1})]),_:1})]),a(B,{open:c.value,"onUpdate:open":e[6]||(e[6]=l=>c.value=l)},{default:o(()=>[a(I,{class:"sm:max-w-md"},{default:o(()=>[a(M,null,{default:o(()=>[a(z,null,{default:o(()=>e[26]||(e[26]=[n("Add Feed Consumption")])),_:1})]),_:1}),t("div",Ee,[t("div",null,[a(i,{for:"day_number"},{default:o(()=>e[27]||(e[27]=[n("Day Number")])),_:1}),a(_,{id:"day_number",modelValue:r.value.day_number,"onUpdate:modelValue":e[1]||(e[1]=l=>r.value.day_number=l),type:"number",min:"1",placeholder:"Enter day number"},null,8,["modelValue"])]),t("div",null,[a(i,{for:"feed_amount"},{default:o(()=>e[28]||(e[28]=[n("Feed Amount (kg)")])),_:1}),a(_,{id:"feed_amount",modelValue:r.value.feed_amount,"onUpdate:modelValue":e[2]||(e[2]=l=>r.value.feed_amount=l),type:"number",step:"0.01",min:"0",placeholder:"Enter feed amount"},null,8,["modelValue"])]),t("div",null,[a(i,{for:"consumption_date"},{default:o(()=>e[29]||(e[29]=[n("Date")])),_:1}),a(_,{id:"consumption_date",modelValue:r.value.consumption_date,"onUpdate:modelValue":e[3]||(e[3]=l=>r.value.consumption_date=l),type:"date"},null,8,["modelValue"])]),t("div",null,[a(i,{for:"notes"},{default:o(()=>e[30]||(e[30]=[n("Notes (Optional)")])),_:1}),a(_,{id:"notes",modelValue:r.value.notes,"onUpdate:modelValue":e[4]||(e[4]=l=>r.value.notes=l),placeholder:"Enter any notes"},null,8,["modelValue"])])]),a(L,null,{default:o(()=>[a(g,{variant:"outline",onClick:e[5]||(e[5]=l=>c.value=!1)},{default:o(()=>e[31]||(e[31]=[n("Cancel")])),_:1}),a(g,{onClick:h,disabled:u.value},{default:o(()=>[n(d(u.value?"Adding...":"Add Consumption"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),a(B,{open:y.value,"onUpdate:open":e[11]||(e[11]=l=>y.value=l)},{default:o(()=>[a(I,{class:"sm:max-w-md"},{default:o(()=>[a(M,null,{default:o(()=>[a(z,null,{default:o(()=>{var l;return[n("Edit Feed Consumption - Day "+d((l=b.value)==null?void 0:l.day_number),1)]}),_:1})]),_:1}),t("div",De,[t("div",null,[a(i,{for:"edit_feed_amount"},{default:o(()=>e[32]||(e[32]=[n("Feed Amount (kg)")])),_:1}),a(_,{id:"edit_feed_amount",modelValue:p.value.feed_amount,"onUpdate:modelValue":e[7]||(e[7]=l=>p.value.feed_amount=l),type:"number",step:"0.01",min:"0",placeholder:"Enter feed amount"},null,8,["modelValue"])]),t("div",null,[a(i,{for:"edit_consumption_date"},{default:o(()=>e[33]||(e[33]=[n("Date")])),_:1}),a(_,{id:"edit_consumption_date",modelValue:p.value.consumption_date,"onUpdate:modelValue":e[8]||(e[8]=l=>p.value.consumption_date=l),type:"date"},null,8,["modelValue"])]),t("div",null,[a(i,{for:"edit_notes"},{default:o(()=>e[34]||(e[34]=[n("Notes (Optional)")])),_:1}),a(_,{id:"edit_notes",modelValue:p.value.notes,"onUpdate:modelValue":e[9]||(e[9]=l=>p.value.notes=l),placeholder:"Enter any notes"},null,8,["modelValue"])])]),a(L,null,{default:o(()=>[a(g,{variant:"outline",onClick:e[10]||(e[10]=l=>y.value=!1)},{default:o(()=>e[35]||(e[35]=[n("Cancel")])),_:1}),a(g,{onClick:q,disabled:u.value},{default:o(()=>[n(d(u.value?"Updating...":"Update Consumption"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})],64))}});export{ze as default};

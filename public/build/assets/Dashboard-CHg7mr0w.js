import{_ as ie}from"./AppLayout.vue_vue_type_script_setup_true_lang-Cfv7ZBw5.js";import{d as de,r as v,c as F,x as X,o as ue,D as ge,a as i,b as n,e as g,u as ve,m as ce,w as p,f as t,t as r,h as S,F as w,j as $,i as Y,g as me,A as y,W as pe,p as Z}from"./app-CzhniAMT.js";import{_ as D}from"./Card.vue_vue_type_script_setup_true_lang-aC5pJkwP.js";import{_ as ee}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-1iHGJxcY.js";import{_ as M}from"./Input.vue_vue_type_script_setup_true_lang-DoOMrtD2.js";import{_ as fe}from"./SamplingTrendsChart.vue_vue_type_script_setup_true_lang-CmknCcPa.js";import"./useForwardExpose-DEh402Yc.js";import"./RovingFocusGroup-Daz5GHfr.js";const _e={class:"flex h-full flex-1 flex-col gap-6 p-4"},he={class:"flex flex-col gap-4"},be={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},xe={class:"text-muted-foreground"},we={class:"flex flex-col sm:flex-row gap-2"},ye={class:"flex gap-1"},ke={key:0,class:"flex gap-2"},Ce={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Se={class:"flex items-center justify-between"},$e={class:"text-sm font-medium text-muted-foreground"},De={class:"text-2xl font-bold"},Ie={class:"text-3xl"},Ve={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Te={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-4"},We={class:"flex flex-col sm:flex-row gap-2"},Ae={class:"investor-dropdown-container"},Le={class:"relative"},Ne={key:0,class:"absolute z-10 w-full sm:w-64 mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-md shadow-lg max-h-60 overflow-auto"},je=["onClick"],Ee={key:0,class:"cage-dropdown-container"},Fe={class:"relative"},Ue={key:0,class:"absolute z-10 w-full sm:w-64 mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-md shadow-lg max-h-60 overflow-auto"},Me=["onClick"],Pe={class:"space-y-4"},ze={class:"grid grid-cols-2 gap-4"},Be={class:"text-center p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg"},Ge={class:"text-2xl font-bold text-blue-600"},Oe={class:"text-center p-3 bg-green-50 dark:bg-green-900/20 rounded-lg"},Re={class:"text-2xl font-bold text-green-600"},qe={class:"grid grid-cols-2 gap-4"},He={class:"text-center p-3 bg-orange-50 dark:bg-orange-900/20 rounded-lg"},Je={class:"text-2xl font-bold text-orange-600"},Ke={class:"text-center p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg"},Qe={class:"text-2xl font-bold text-purple-600"},Xe={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Ye={class:"space-y-3"},Ze={class:"flex items-center gap-3"},et={class:"w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-bold"},tt={class:"font-medium"},st={class:"text-sm text-muted-foreground"},lt={class:"text-right"},ot={class:"font-medium"},at={key:0,class:"text-center py-8 text-muted-foreground"},rt={class:"space-y-3"},nt={class:"font-medium"},it={class:"text-sm text-muted-foreground"},dt={class:"text-right"},ut={class:"font-medium"},gt={key:0,class:"text-center py-8 text-muted-foreground"},vt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ct={class:"text-center p-6 bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 rounded-lg"},mt={class:"text-xs text-muted-foreground mt-1"},pt={class:"text-center p-6 bg-gradient-to-r from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 rounded-lg"},ft={class:"text-xs text-muted-foreground mt-1"},St=de({__name:"Dashboard",props:{analytics:{}},setup(te){const se=te,le=[{title:"Dashboard",href:"/dashboard"}],I=v("30days"),V=v(""),T=v(""),d=v(null),c=v(null),W=v([]),U=v([]),b=v(""),x=v(""),P=v(!1),z=v(!1),k=v(!1),C=v(!1),oe=[{value:"day",label:"Today"},{value:"week",label:"This Week"},{value:"30days",label:"Last 30 Days"},{value:"month",label:"This Month"},{value:"custom",label:"Custom Range"}],o=F(()=>se.analytics||{}),ae=F(()=>{var l,e,u,_,L,a,s,m,h,N,j,E;return[{title:"Total Investors",value:((l=o.value.summary)==null?void 0:l.total_investors)||0,icon:"ðŸ‘¥",color:"bg-blue-500",change:"+12%",changeType:"positive"},{title:"Total Cages",value:((e=o.value.summary)==null?void 0:e.total_cages)||0,icon:"ðŸ ",color:"bg-green-500",change:"+5%",changeType:"positive"},{title:"Samplings This Period",value:((u=o.value.summary)==null?void 0:u.samplings_in_period)||0,icon:"ðŸ“Š",color:"bg-purple-500",change:((_=o.value.growth_metrics)==null?void 0:_.sampling_growth)>0?`+${(L=o.value.growth_metrics)==null?void 0:L.sampling_growth}%`:`${(a=o.value.growth_metrics)==null?void 0:a.sampling_growth}%`,changeType:((s=o.value.growth_metrics)==null?void 0:s.sampling_growth)>0?"positive":"negative"},{title:"Avg Sample Weight",value:`${((m=o.value.weight_stats)==null?void 0:m.avg_weight)||0}g`,icon:"âš–ï¸",color:"bg-orange-500",change:((h=o.value.growth_metrics)==null?void 0:h.weight_growth)>0?`+${(N=o.value.growth_metrics)==null?void 0:N.weight_growth}%`:`${(j=o.value.growth_metrics)==null?void 0:j.weight_growth}%`,changeType:((E=o.value.growth_metrics)==null?void 0:E.weight_growth)>0?"positive":"negative"}]});F(()=>{const l=o.value.sampling_trends||[];return{labels:l.map(e=>new Date(e.date).toLocaleDateString()),datasets:[{label:"Samplings",data:l.map(e=>e.count),borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4},{label:"Avg Weight (g)",data:l.map(e=>e.avg_weight),borderColor:"rgb(16, 185, 129)",backgroundColor:"rgba(16, 185, 129, 0.1)",tension:.4,yAxisID:"y1"}]}});function re(l){I.value=l,l!=="custom"&&f()}function f(){const l={period:I.value};I.value==="custom"&&V.value&&T.value&&(l.start_date=V.value,l.end_date=T.value),d.value&&(l.investor_id=d.value),c.value&&(l.cage_no=c.value),pe.get("/dashboard",l,{preserveState:!0,preserveScroll:!0})}function ne(){V.value&&T.value&&f()}function B(l){return new Intl.NumberFormat().format(l)}function A(l){return`${l.toFixed(1)}g`}async function G(){if(!(W.value.length>0)){P.value=!0;try{const l=await Z.get(route("investors.select"));W.value=l.data}catch(l){console.error("Error fetching investors:",l)}finally{P.value=!1}}}async function O(){if(!d.value){U.value=[],c.value=null;return}z.value=!0;try{const l=await Z.get(route("cages.select"),{params:{investor_id:d.value}});U.value=l.data}catch(l){console.error("Error fetching cages:",l)}finally{z.value=!1}}const R=F(()=>{if(!b.value)return W.value;const l=b.value.toLowerCase();return W.value.filter(e=>{var u;return(u=e.name)==null?void 0:u.toLowerCase().includes(l)})}),q=F(()=>{if(!x.value)return U.value;const l=x.value.toLowerCase();return U.value.filter(e=>{var u,_;return((u=e.id)==null?void 0:u.toString().includes(l))||((_=e.number_of_fingerlings)==null?void 0:_.toString().includes(l))})});X(d,()=>{c.value=null,O(),f()}),X(c,()=>{f()});function H(l){const e=l.target;e.closest(".investor-dropdown-container")||(k.value=!1),e.closest(".cage-dropdown-container")||(C.value=!1)}return ue(()=>{G();const l=new URLSearchParams(window.location.search),e=l.get("investor_id"),u=l.get("cage_no");e&&(d.value=e,O().then(()=>{u&&(c.value=u)})),document.addEventListener("click",H)}),ge(()=>{document.removeEventListener("click",H)}),(l,e)=>(n(),i(w,null,[g(ve(ce),{title:"Dashboard"}),g(ie,{breadcrumbs:le},{default:p(()=>{var u,_,L;return[t("div",_e,[t("div",he,[t("div",be,[t("div",null,[e[10]||(e[10]=t("h1",{class:"text-2xl font-bold"},"Dashboard Analytics",-1)),t("p",xe,r(((u=o.value.date_range)==null?void 0:u.period)||"This Month")+" ("+r((_=o.value.date_range)==null?void 0:_.start)+" to "+r((L=o.value.date_range)==null?void 0:L.end)+") ",1)]),t("div",we,[t("div",ye,[(n(),i(w,null,$(oe,a=>g(ee,{key:a.value,variant:I.value===a.value?"default":"outline",size:"sm",onClick:s=>re(a.value)},{default:p(()=>[Y(r(a.label),1)]),_:2},1032,["variant","onClick"])),64))]),I.value==="custom"?(n(),i("div",ke,[g(M,{modelValue:V.value,"onUpdate:modelValue":e[0]||(e[0]=a=>V.value=a),type:"date",placeholder:"Start Date",class:"w-32"},null,8,["modelValue"]),g(M,{modelValue:T.value,"onUpdate:modelValue":e[1]||(e[1]=a=>T.value=a),type:"date",placeholder:"End Date",class:"w-32"},null,8,["modelValue"]),g(ee,{onClick:ne,size:"sm"},{default:p(()=>e[11]||(e[11]=[Y(" Apply ")])),_:1})])):S("",!0)])])]),t("div",Ce,[(n(!0),i(w,null,$(ae.value,a=>(n(),me(D,{key:a.title,class:"p-4"},{default:p(()=>[t("div",Se,[t("div",null,[t("p",$e,r(a.title),1),t("p",De,r(a.value),1),t("p",{class:y(["text-xs",a.changeType==="positive"?"text-green-600":"text-red-600"])},r(a.change)+" from last period ",3)]),t("div",Ie,r(a.icon),1)])]),_:2},1024))),128))]),t("div",Ve,[g(D,{class:"p-6"},{default:p(()=>{var a;return[t("div",Te,[e[14]||(e[14]=t("h3",{class:"text-lg font-semibold"},"Sampling Trends",-1)),t("div",We,[t("div",Ae,[t("div",Le,[g(M,{modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=s=>b.value=s),type:"text",placeholder:d.value?((a=W.value.find(s=>s.id.toString()===d.value))==null?void 0:a.name)||"Search investor...":"Investor",class:"w-full sm:w-40",onFocus:e[3]||(e[3]=s=>{k.value=!0,G()}),onInput:e[4]||(e[4]=s=>k.value=!0)},null,8,["modelValue","placeholder"]),k.value&&(b.value||R.value.length>0)?(n(),i("div",Ne,[t("button",{type:"button",class:y(["w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700",{"bg-blue-50 dark:bg-blue-900/20":!d.value}]),onClick:e[5]||(e[5]=s=>{d.value=null,b.value="",k.value=!1,f()})},e[12]||(e[12]=[t("span",{class:"font-medium"},"All Investors (Overall)",-1)]),2),(n(!0),i(w,null,$(R.value,s=>(n(),i("div",{key:s.id,class:y(["px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",{"bg-blue-50 dark:bg-blue-900/20":d.value===s.id.toString()}]),onClick:m=>{d.value=s.id.toString(),b.value=s.name,k.value=!1,f()}},r(s.name),11,je))),128))])):S("",!0)])]),d.value?(n(),i("div",Ee,[t("div",Fe,[g(M,{modelValue:x.value,"onUpdate:modelValue":e[6]||(e[6]=s=>x.value=s),type:"text",placeholder:c.value?`Cage ${c.value}`:"Cage",class:"w-full sm:w-32",disabled:!d.value,onFocus:e[7]||(e[7]=s=>C.value=!0),onInput:e[8]||(e[8]=s=>C.value=!0)},null,8,["modelValue","placeholder","disabled"]),C.value&&(x.value||q.value.length>0)&&d.value?(n(),i("div",Ue,[t("button",{type:"button",class:y(["w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700",{"bg-blue-50 dark:bg-blue-900/20":!c.value}]),onClick:e[9]||(e[9]=s=>{c.value=null,x.value="",C.value=!1,f()})},e[13]||(e[13]=[t("span",{class:"font-medium"},"All Cages (Investor Overall)",-1)]),2),(n(!0),i(w,null,$(q.value,s=>(n(),i("div",{key:s.id,class:y(["px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",{"bg-blue-50 dark:bg-blue-900/20":c.value===s.id.toString()}]),onClick:m=>{c.value=s.id.toString(),x.value=`Cage ${s.id}`,C.value=!1,f()}}," Cage "+r(s.id)+" ("+r(s.number_of_fingerlings)+" fingerlings) ",11,Me))),128))])):S("",!0)])])):S("",!0)])]),g(fe,{trends:o.value.sampling_trends||[]},null,8,["trends"])]}),_:1}),g(D,{class:"p-6"},{default:p(()=>{var a,s,m,h;return[e[19]||(e[19]=t("h3",{class:"text-lg font-semibold mb-4"},"Weight Statistics",-1)),t("div",Pe,[t("div",ze,[t("div",Be,[t("p",Ge,r(A(((a=o.value.weight_stats)==null?void 0:a.avg_weight)||0)),1),e[15]||(e[15]=t("p",{class:"text-sm text-muted-foreground"},"Average Weight",-1))]),t("div",Oe,[t("p",Re,r(A(((s=o.value.weight_stats)==null?void 0:s.max_weight)||0)),1),e[16]||(e[16]=t("p",{class:"text-sm text-muted-foreground"},"Max Weight",-1))])]),t("div",qe,[t("div",He,[t("p",Je,r(A(((m=o.value.weight_stats)==null?void 0:m.min_weight)||0)),1),e[17]||(e[17]=t("p",{class:"text-sm text-muted-foreground"},"Min Weight",-1))]),t("div",Ke,[t("p",Qe,r(B(((h=o.value.weight_stats)==null?void 0:h.total_weight)||0))+"g",1),e[18]||(e[18]=t("p",{class:"text-sm text-muted-foreground"},"Total Weight",-1))])])])]}),_:1})]),t("div",Xe,[g(D,{class:"p-6"},{default:p(()=>{var a;return[e[21]||(e[21]=t("h3",{class:"text-lg font-semibold mb-4"},"Top Performing Investors",-1)),t("div",Ye,[(n(!0),i(w,null,$(o.value.top_investors,(s,m)=>(n(),i("div",{key:s.id,class:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg"},[t("div",Ze,[t("div",et,r(m+1),1),t("div",null,[t("p",tt,r(s.name),1),t("p",st,r(s.samplings_count)+" samplings",1)])]),t("div",lt,[t("p",ot,r(B(s.samples_sum_weight||0))+"g",1),e[20]||(e[20]=t("p",{class:"text-sm text-muted-foreground"},"Total weight",-1))])]))),128)),(a=o.value.top_investors)!=null&&a.length?S("",!0):(n(),i("div",at," No data available "))])]}),_:1}),g(D,{class:"p-6"},{default:p(()=>{var a;return[e[23]||(e[23]=t("h3",{class:"text-lg font-semibold mb-4"},"Feed Type Usage",-1)),t("div",rt,[(n(!0),i(w,null,$(o.value.feed_type_usage,s=>(n(),i("div",{key:s.feed_type,class:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg"},[t("div",null,[t("p",nt,r(s.feed_type),1),t("p",it,r(s.brand),1)]),t("div",dt,[t("p",ut,r(s.cage_count),1),e[22]||(e[22]=t("p",{class:"text-sm text-muted-foreground"},"cages",-1))])]))),128)),(a=o.value.feed_type_usage)!=null&&a.length?S("",!0):(n(),i("div",gt," No data available "))])]}),_:1})]),g(D,{class:"p-6"},{default:p(()=>{var a,s,m,h,N,j,E,J,K,Q;return[e[28]||(e[28]=t("h3",{class:"text-lg font-semibold mb-4"},"Growth Metrics",-1)),t("div",vt,[t("div",ct,[e[24]||(e[24]=t("div",{class:"text-3xl mb-2"},"ðŸ“Š",-1)),t("p",{class:y(["text-2xl font-bold",((a=o.value.growth_metrics)==null?void 0:a.sampling_growth)>0?"text-green-600":"text-red-600"])},r(((s=o.value.growth_metrics)==null?void 0:s.sampling_growth)>0?"+":"")+r(((m=o.value.growth_metrics)==null?void 0:m.sampling_growth)||0)+"% ",3),e[25]||(e[25]=t("p",{class:"text-sm text-muted-foreground"},"Sampling Growth",-1)),t("p",mt,r(((h=o.value.growth_metrics)==null?void 0:h.current_samplings)||0)+" vs "+r(((N=o.value.growth_metrics)==null?void 0:N.previous_samplings)||0),1)]),t("div",pt,[e[26]||(e[26]=t("div",{class:"text-3xl mb-2"},"âš–ï¸",-1)),t("p",{class:y(["text-2xl font-bold",((j=o.value.growth_metrics)==null?void 0:j.weight_growth)>0?"text-green-600":"text-red-600"])},r(((E=o.value.growth_metrics)==null?void 0:E.weight_growth)>0?"+":"")+r(((J=o.value.growth_metrics)==null?void 0:J.weight_growth)||0)+"% ",3),e[27]||(e[27]=t("p",{class:"text-sm text-muted-foreground"},"Weight Growth",-1)),t("p",ft,r(A(((K=o.value.growth_metrics)==null?void 0:K.current_avg_weight)||0))+" vs "+r(A(((Q=o.value.growth_metrics)==null?void 0:Q.previous_avg_weight)||0)),1)])])]}),_:1})])]}),_:1})],64))}});export{St as default};

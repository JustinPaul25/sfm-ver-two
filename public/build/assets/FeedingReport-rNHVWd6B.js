import{d as Q,r as f,o as X,g as V,b as i,w as l,e as s,f as e,u as Y,m as Z,a as u,i as n,l as O,F as w,j as h,t as o,v as P,A as D,h as E}from"./app-CzhniAMT.js";import{_ as ee}from"./AppLayout.vue_vue_type_script_setup_true_lang-Cfv7ZBw5.js";import{_ as p}from"./Card.vue_vue_type_script_setup_true_lang-aC5pJkwP.js";import{_ as x,a as z,b as m}from"./CardTitle.vue_vue_type_script_setup_true_lang-tScOHRnG.js";import{_}from"./CardDescription.vue_vue_type_script_setup_true_lang-C1AcIPii.js";import{_ as S}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-1iHGJxcY.js";import{_ as M}from"./Input.vue_vue_type_script_setup_true_lang-DoOMrtD2.js";import{_ as T}from"./Label.vue_vue_type_script_setup_true_lang-BKKMizY2.js";import{_ as G}from"./Separator.vue_vue_type_script_setup_true_lang-DRvwWSvT.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useForwardExpose-DEh402Yc.js";import"./RovingFocusGroup-Daz5GHfr.js";const se={class:"flex flex-col gap-6 p-4 max-w-7xl mx-auto print:p-2"},le={class:"flex items-center justify-between print:hidden"},de={class:"flex gap-2"},oe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},ae=["value"],ne=["value"],re={class:"flex gap-2 mt-4"},ie={key:0},ue={class:"mb-4"},fe={class:"text-muted-foreground"},pe={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4"},me={class:"text-2xl font-bold"},ve={class:"text-2xl font-bold text-blue-600"},xe={class:"text-2xl font-bold text-green-600"},_e={class:"text-2xl font-bold"},ge={class:"text-2xl font-bold"},ce={class:"space-y-4"},be={class:"flex items-start justify-between"},ye={class:"flex-1"},ke={key:0,class:"px-2 py-1 text-xs rounded-md bg-secondary text-secondary-foreground"},we={class:"grid grid-cols-2 md:grid-cols-4 gap-2 mt-2"},he={class:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-4"},De={class:"text-lg font-semibold"},Se={class:"text-lg font-semibold"},Ce={class:"text-lg font-semibold"},Fe={class:"text-lg font-semibold"},Ve={key:0,class:"mb-4"},Te={class:"flex gap-2 flex-wrap"},Re={key:1,class:"mt-4"},Ae={class:"overflow-x-auto"},$e={class:"w-full text-sm"},Ee={class:"px-4 py-2"},Ne={class:"px-4 py-2"},Ue={class:"px-4 py-2 text-right"},Le={class:"px-4 py-2 text-right font-medium"},je={class:"px-4 py-2 text-center"},Be={class:"px-4 py-2 text-muted-foreground"},Ie=Q({__name:"FeedingReport",setup(We){const k=f(!1),R=f([]),v=f({total_cages:0,total_feed_consumed:0,total_scheduled_feed:0,average_adherence:0,cages_with_schedules:0,active_schedules:0}),C=f({start_date:"",end_date:"",days_count:0}),N=f([]),U=f([]),g=f(""),c=f(""),b=f(""),y=f(""),F=f(new Set),L=()=>{const a=new Date,t=new Date(a),d=a.getDay(),r=a.getDate()-d+(d===0?-6:1);t.setDate(r);const W=new Date(t);W.setDate(t.getDate()+6),g.value=t.toISOString().split("T")[0],c.value=W.toISOString().split("T")[0]},A=async()=>{k.value=!0;try{const a=new URLSearchParams;g.value&&a.append("start_date",g.value),c.value&&a.append("end_date",c.value),y.value&&a.append("cage_id",y.value),b.value&&a.append("investor_id",b.value);const d=await(await fetch(route("reports.feeding.weekly")+"?"+a.toString())).json();R.value=d.report_data,v.value=d.summary,C.value=d.period,d.filters&&(N.value=d.filters.investors,U.value=d.filters.cages)}catch(a){console.error("Error fetching report:",a)}finally{k.value=!1}},q=a=>{F.value.has(a)?F.value.delete(a):F.value.add(a)},j=a=>F.value.has(a),H=()=>{const a=new URLSearchParams;g.value&&a.append("start_date",g.value),c.value&&a.append("end_date",c.value),y.value&&a.append("cage_id",y.value),b.value&&a.append("investor_id",b.value),window.open(route("reports.feeding.export-weekly")+"?"+a.toString(),"_blank")},J=()=>{window.print()},B=a=>a>=90?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":a>=70?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400":"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400",I=a=>a>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400",$=a=>new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),K=()=>{L(),b.value="",y.value="",A()};return X(()=>{L(),A()}),(a,t)=>(i(),V(ee,null,{default:l(()=>[s(Y(Z),{title:"Weekly Feeding Report"}),e("div",se,[e("div",le,[t[6]||(t[6]=e("div",null,[e("h1",{class:"text-3xl font-bold"},"Weekly Feeding Report"),e("p",{class:"text-muted-foreground mt-1"}," Track feeding schedules and consumption patterns ")],-1)),e("div",de,[s(S,{variant:"outline",onClick:J},{default:l(()=>t[4]||(t[4]=[n(" ðŸ–¨ï¸ Print ")])),_:1}),s(S,{onClick:H},{default:l(()=>t[5]||(t[5]=[n(" ðŸ“Š Export Excel ")])),_:1})])]),s(p,{class:"print:hidden"},{default:l(()=>[s(x,null,{default:l(()=>[s(z,null,{default:l(()=>t[7]||(t[7]=[n("Filters")])),_:1}),s(_,null,{default:l(()=>t[8]||(t[8]=[n("Select date range and filters to generate the report")])),_:1})]),_:1}),s(m,null,{default:l(()=>[e("div",oe,[e("div",null,[s(T,{for:"start-date"},{default:l(()=>t[9]||(t[9]=[n("Start Date")])),_:1}),s(M,{id:"start-date",type:"date",modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=d=>g.value=d)},null,8,["modelValue"])]),e("div",null,[s(T,{for:"end-date"},{default:l(()=>t[10]||(t[10]=[n("End Date")])),_:1}),s(M,{id:"end-date",type:"date",modelValue:c.value,"onUpdate:modelValue":t[1]||(t[1]=d=>c.value=d)},null,8,["modelValue"])]),e("div",null,[s(T,{for:"investor"},{default:l(()=>t[11]||(t[11]=[n("Investor")])),_:1}),O(e("select",{id:"investor","onUpdate:modelValue":t[2]||(t[2]=d=>b.value=d),class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-md focus:outline-none focus:ring-2 focus:ring-ring focus:border-ring transition-colors"},[t[12]||(t[12]=e("option",{value:""},"All Investors",-1)),(i(!0),u(w,null,h(N.value,d=>(i(),u("option",{key:d.id,value:d.id.toString()},o(d.name),9,ae))),128))],512),[[P,b.value]])]),e("div",null,[s(T,{for:"cage"},{default:l(()=>t[13]||(t[13]=[n("Cage")])),_:1}),O(e("select",{id:"cage","onUpdate:modelValue":t[3]||(t[3]=d=>y.value=d),class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-md focus:outline-none focus:ring-2 focus:ring-ring focus:border-ring transition-colors"},[t[14]||(t[14]=e("option",{value:""},"All Cages",-1)),(i(!0),u(w,null,h(U.value,d=>(i(),u("option",{key:d.id,value:d.id.toString()},o(d.label),9,ne))),128))],512),[[P,y.value]])])]),e("div",re,[s(S,{onClick:A,disabled:k.value},{default:l(()=>[n(o(k.value?"Loading...":"Generate Report"),1)]),_:1},8,["disabled"]),s(S,{variant:"outline",onClick:K},{default:l(()=>t[15]||(t[15]=[n(" Reset Filters ")])),_:1})])]),_:1})]),_:1}),R.value.length>0?(i(),u("div",ie,[e("div",ue,[t[16]||(t[16]=e("h2",{class:"text-xl font-semibold mb-2"},"Report Period",-1)),e("p",fe,o($(C.value.start_date))+" - "+o($(C.value.end_date))+" ("+o(C.value.days_count)+" days) ",1)]),e("div",pe,[s(p,null,{default:l(()=>[s(x,{class:"pb-2"},{default:l(()=>[s(_,null,{default:l(()=>t[17]||(t[17]=[n("Total Cages")])),_:1})]),_:1}),s(m,null,{default:l(()=>[e("div",me,o(v.value.total_cages),1)]),_:1})]),_:1}),s(p,null,{default:l(()=>[s(x,{class:"pb-2"},{default:l(()=>[s(_,null,{default:l(()=>t[18]||(t[18]=[n("With Schedules")])),_:1})]),_:1}),s(m,null,{default:l(()=>[e("div",ve,o(v.value.cages_with_schedules),1)]),_:1})]),_:1}),s(p,null,{default:l(()=>[s(x,{class:"pb-2"},{default:l(()=>[s(_,null,{default:l(()=>t[19]||(t[19]=[n("Active Schedules")])),_:1})]),_:1}),s(m,null,{default:l(()=>[e("div",xe,o(v.value.active_schedules),1)]),_:1})]),_:1}),s(p,null,{default:l(()=>[s(x,{class:"pb-2"},{default:l(()=>[s(_,null,{default:l(()=>t[20]||(t[20]=[n("Total Scheduled")])),_:1})]),_:1}),s(m,null,{default:l(()=>[e("div",_e,o(v.value.total_scheduled_feed.toFixed(2)),1),t[21]||(t[21]=e("div",{class:"text-xs text-muted-foreground"},"kg",-1))]),_:1})]),_:1}),s(p,null,{default:l(()=>[s(x,{class:"pb-2"},{default:l(()=>[s(_,null,{default:l(()=>t[22]||(t[22]=[n("Total Consumed")])),_:1})]),_:1}),s(m,null,{default:l(()=>[e("div",ge,o(v.value.total_feed_consumed.toFixed(2)),1),t[23]||(t[23]=e("div",{class:"text-xs text-muted-foreground"},"kg",-1))]),_:1})]),_:1}),s(p,null,{default:l(()=>[s(x,{class:"pb-2"},{default:l(()=>[s(_,null,{default:l(()=>t[24]||(t[24]=[n("Avg Adherence")])),_:1})]),_:1}),s(m,null,{default:l(()=>[e("div",{class:D(["text-2xl font-bold",v.value.average_adherence>=90?"text-green-600":v.value.average_adherence>=70?"text-yellow-600":"text-red-600"])},o(v.value.average_adherence)+"% ",3)]),_:1})]),_:1})]),s(G,{class:"my-6"}),e("div",ce,[t[37]||(t[37]=e("h2",{class:"text-2xl font-bold"},"Cage Details",-1)),(i(!0),u(w,null,h(R.value,d=>(i(),V(p,{key:d.cage_id,class:"overflow-hidden"},{default:l(()=>[s(x,{class:"bg-muted/50"},{default:l(()=>[e("div",be,[e("div",ye,[s(z,{class:"flex items-center gap-2"},{default:l(()=>[n(" Cage #"+o(d.cage_number)+" ",1),d.has_schedule?E("",!0):(i(),u("span",ke,"No Schedule"))]),_:2},1024),s(_,{class:"mt-2"},{default:l(()=>[e("div",we,[e("div",null,[t[25]||(t[25]=e("span",{class:"font-medium"},"Investor:",-1)),n(" "+o(d.investor_name),1)]),e("div",null,[t[26]||(t[26]=e("span",{class:"font-medium"},"Feed Type:",-1)),n(" "+o(d.feed_type),1)]),e("div",null,[t[27]||(t[27]=e("span",{class:"font-medium"},"Fingerlings:",-1)),n(" "+o(d.fingerlings_count),1)]),e("div",null,[t[28]||(t[28]=e("span",{class:"font-medium"},"Schedule:",-1)),n(" "+o(d.schedule_name),1)])])]),_:2},1024)]),s(S,{variant:"ghost",size:"sm",onClick:r=>q(d.cage_id),class:"print:hidden"},{default:l(()=>[n(o(j(d.cage_id)?"â–¼":"â–¶"),1)]),_:2},1032,["onClick"])])]),_:2},1024),s(m,{class:"pt-4"},{default:l(()=>[e("div",he,[e("div",null,[t[29]||(t[29]=e("div",{class:"text-sm text-muted-foreground"},"Scheduled Total",-1)),e("div",De,o(d.total_scheduled.toFixed(2))+" kg",1)]),e("div",null,[t[30]||(t[30]=e("div",{class:"text-sm text-muted-foreground"},"Consumed Total",-1)),e("div",Se,o(d.total_consumed.toFixed(2))+" kg",1)]),e("div",null,[t[31]||(t[31]=e("div",{class:"text-sm text-muted-foreground"},"Variance",-1)),e("div",{class:D(["text-lg font-semibold",I(d.variance)])},o(d.variance>=0?"+":"")+o(d.variance.toFixed(2))+" kg ",3)]),e("div",null,[t[32]||(t[32]=e("div",{class:"text-sm text-muted-foreground"},"Adherence Rate",-1)),e("div",Ce,[e("span",{class:D(["px-3 py-1 rounded-md text-sm font-medium",B(d.adherence_rate)])},o(d.adherence_rate)+"% ",3)])]),e("div",null,[t[33]||(t[33]=e("div",{class:"text-sm text-muted-foreground"},"Daily Average",-1)),e("div",Fe,o(d.average_daily_consumption.toFixed(2))+" kg",1)])]),d.feeding_times.length>0?(i(),u("div",Ve,[t[34]||(t[34]=e("div",{class:"text-sm font-medium mb-1"},"Feeding Times:",-1)),e("div",Te,[(i(!0),u(w,null,h(d.feeding_times,r=>(i(),u("span",{key:r,class:"px-3 py-1 border border-border rounded-md text-sm"}," ðŸ• "+o(r),1))),128))])])):E("",!0),j(d.cage_id)?(i(),u("div",Re,[s(G,{class:"mb-4"}),t[36]||(t[36]=e("h4",{class:"font-semibold mb-3"},"Daily Breakdown",-1)),e("div",Ae,[e("table",$e,[t[35]||(t[35]=e("thead",{class:"bg-muted"},[e("tr",null,[e("th",{class:"px-4 py-2 text-left"},"Date"),e("th",{class:"px-4 py-2 text-left"},"Day"),e("th",{class:"px-4 py-2 text-right"},"Scheduled (kg)"),e("th",{class:"px-4 py-2 text-right"},"Actual (kg)"),e("th",{class:"px-4 py-2 text-right"},"Variance (kg)"),e("th",{class:"px-4 py-2 text-center"},"Adherence"),e("th",{class:"px-4 py-2 text-left"},"Notes")])],-1)),e("tbody",null,[(i(!0),u(w,null,h(d.daily_breakdown,r=>(i(),u("tr",{key:r.date,class:"border-b"},[e("td",Ee,o($(r.date)),1),e("td",Ne,o(r.day_name),1),e("td",Ue,o(r.scheduled_amount.toFixed(2)),1),e("td",Le,o(r.actual_amount.toFixed(2)),1),e("td",{class:D(["px-4 py-2 text-right",I(r.variance)])},o(r.variance>=0?"+":"")+o(r.variance.toFixed(2)),3),e("td",je,[e("span",{class:D(["px-2 py-1 rounded text-xs font-medium inline-block",B(r.adherence_rate)])},o(r.adherence_rate)+"% ",3)]),e("td",Be,o(r.notes||"-"),1)]))),128))])])])])):E("",!0)]),_:2},1024)]),_:2},1024))),128))])])):k.value?(i(),V(p,{key:2},{default:l(()=>[s(m,{class:"py-12 text-center"},{default:l(()=>t[39]||(t[39]=[e("div",{class:"text-muted-foreground"},[e("div",{class:"text-4xl mb-2"},"â³"),e("p",{class:"text-lg"},"Loading report...")],-1)])),_:1})]),_:1})):(i(),V(p,{key:1},{default:l(()=>[s(m,{class:"py-12 text-center"},{default:l(()=>t[38]||(t[38]=[e("div",{class:"text-muted-foreground mb-4"},[e("div",{class:"text-4xl mb-2"},"ðŸ“Š"),e("p",{class:"text-lg"},"No data available for the selected period"),e("p",{class:"text-sm mt-2"},"Try adjusting your filters or date range")],-1)])),_:1})]),_:1}))])]),_:1}))}}),Ze=te(Ie,[["__scopeId","data-v-d886e482"]]);export{Ze as default};

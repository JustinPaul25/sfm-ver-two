import{d as Q,r as f,c as N,o as X,a as V,b as k,e as a,u as $,m as Y,w as n,f as t,g as Z,h as A,t as d,P as ee,i as s,F as U,j as te,W as x}from"./app-cXB0WXeG.js";import{_ as ae}from"./AppLayout.vue_vue_type_script_setup_true_lang-BqJlz97b.js";import{_ as g}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BzgCzate.js";import{_ as S}from"./Card.vue_vue_type_script_setup_true_lang-DjVIjL4h.js";import{_ as O,a as T,b as j}from"./CardTitle.vue_vue_type_script_setup_true_lang-CUjEnbf9.js";import{_ as v}from"./Input.vue_vue_type_script_setup_true_lang-Cu7ak-py.js";import{_ as i}from"./Label.vue_vue_type_script_setup_true_lang-CwGLpo82.js";import{_ as B,a as I,b as M,c as h}from"./DialogTitle.vue_vue_type_script_setup_true_lang-6qZcBAmY.js";import{_ as L}from"./DialogFooter.vue_vue_type_script_setup_true_lang-D7RWneW6.js";import"./useForwardExpose-CPJbi8KW.js";import"./RovingFocusGroup-B5r2yRVB.js";const oe={class:"max-w-6xl mx-auto p-6 space-y-6"},ne={class:"flex items-center justify-between"},le={class:"text-3xl font-bold"},se={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},de={class:"text-2xl font-bold text-primary"},ue={class:"text-lg"},re={class:"text-lg"},ie={class:"flex items-center justify-between"},me={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},pe={class:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg"},fe={class:"text-2xl font-bold text-blue-700 dark:text-blue-300"},ge={class:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg"},_e={class:"text-2xl font-bold text-green-700 dark:text-green-300"},ve={class:"p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg"},xe={class:"text-2xl font-bold text-purple-700 dark:text-purple-300"},ce={class:"overflow-x-auto"},ye={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},be={class:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700"},ke={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},we={class:"px-6 py-4 whitespace-nowrap text-sm"},Ce={class:"px-6 py-4 whitespace-nowrap text-sm"},Ve={class:"px-6 py-4 text-sm"},$e={class:"px-6 py-4 whitespace-nowrap text-sm"},Fe={class:"flex space-x-2"},De={key:0},Ee={class:"space-y-4"},Ne={class:"space-y-4"},ze=Q({__name:"View",props:{cage:{},feedConsumptions:{},errors:{},flash:{}},setup(z){const F=z,_=F.cage.id,P=[{title:"Dashboard",href:"/dashboard"},{title:"Cages",href:"/cages"},{title:`View Cage #${_}`,href:`/cages/${_}/view`}],w=f(F.cage),m=f(F.feedConsumptions),c=f(!1),y=f(!1),b=f(null),u=f(!1),r=f({day_number:1,feed_amount:"",consumption_date:new Date().toISOString().split("T")[0],notes:""}),p=f({feed_amount:"",consumption_date:"",notes:""}),D=N(()=>m.value.reduce((l,e)=>l+parseFloat(e.feed_amount||"0"),0)),W=N(()=>m.value.length===0?0:D.value/m.value.length),R=l=>{if(!l)return"-";try{const e=new Date(l);if(isNaN(e.getTime()))return"-";const o={year:"numeric",month:"short",day:"numeric"};return e.toLocaleDateString("en-US",o)}catch{return"-"}},q=async()=>{u.value=!0;try{await x.post(`/cages/${_}/feed-consumptions`,r.value,{onSuccess:()=>{c.value=!1,K(),x.reload()},onError:l=>{const e=l.message||Object.values(l)[0]||"Error adding feed consumption";alert(e)},onFinish:()=>{u.value=!1}})}catch(l){console.error("Error adding feed consumption:",l),alert("Error adding feed consumption"),u.value=!1}},G=async()=>{if(b.value){u.value=!0;try{await x.put(`/cages/${_}/feed-consumptions/${b.value.id}`,p.value,{onSuccess:()=>{y.value=!1,b.value=null,x.reload()},onError:l=>{const e=l.message||Object.values(l)[0]||"Error updating feed consumption";alert(e)},onFinish:()=>{u.value=!1}})}catch(l){console.error("Error updating feed consumption:",l),alert("Error updating feed consumption"),u.value=!1}}},H=async l=>{if(confirm("Are you sure you want to delete this feed consumption record?"))try{await x.delete(`/cages/${_}/feed-consumptions/${l.id}`,{onSuccess:()=>{x.reload()},onError:e=>{const o=e.message||Object.values(e)[0]||"Error deleting feed consumption";alert(o)}})}catch(e){console.error("Error deleting feed consumption:",e),alert("Error deleting feed consumption")}},J=l=>{b.value=l,p.value={feed_amount:l.feed_amount,consumption_date:l.consumption_date,notes:l.notes||""},y.value=!0},K=()=>{const l=m.value.length>0?Math.max(...m.value.map(e=>e.day_number)):0;r.value={day_number:l+1,feed_amount:"",consumption_date:new Date().toISOString().split("T")[0],notes:""}};return X(()=>{}),(l,e)=>(k(),V(U,null,[a($(Y),{title:`View Cage #${$(_)}`},null,8,["title"]),a(ae,{breadcrumbs:P},{default:n(()=>[t("div",oe,[t("div",ne,[t("h1",le,"Cage #"+d($(_)),1),a($(ee),{href:"/cages"},{default:n(()=>[a(g,{variant:"secondary"},{default:n(()=>e[12]||(e[12]=[s("Back to Cages")])),_:1})]),_:1})]),w.value?(k(),Z(S,{key:0},{default:n(()=>[a(O,null,{default:n(()=>[a(T,null,{default:n(()=>e[13]||(e[13]=[s("Cage Information")])),_:1})]),_:1}),a(j,null,{default:n(()=>{var o,C,E;return[t("div",se,[t("div",null,[a(i,null,{default:n(()=>e[14]||(e[14]=[s("Number of Fingerlings")])),_:1}),t("p",de,d((o=w.value.number_of_fingerlings)==null?void 0:o.toLocaleString()),1)]),t("div",null,[a(i,null,{default:n(()=>e[15]||(e[15]=[s("Feed Type")])),_:1}),t("p",ue,d((C=w.value.feed_type)==null?void 0:C.name),1)]),t("div",null,[a(i,null,{default:n(()=>e[16]||(e[16]=[s("Investor")])),_:1}),t("p",re,d((E=w.value.investor)==null?void 0:E.name),1)])])]}),_:1})]),_:1})):A("",!0),a(S,null,{default:n(()=>[a(O,null,{default:n(()=>[t("div",ie,[a(T,null,{default:n(()=>e[17]||(e[17]=[s("Daily Feed Consumption")])),_:1}),a(g,{onClick:e[0]||(e[0]=o=>c.value=!0)},{default:n(()=>e[18]||(e[18]=[s("Add Feed Consumption")])),_:1})])]),_:1}),a(j,null,{default:n(()=>[t("div",me,[t("div",pe,[e[19]||(e[19]=t("h3",{class:"text-sm font-medium text-blue-600 dark:text-blue-400"},"Total Days Recorded",-1)),t("p",fe,d(m.value.length),1)]),t("div",ge,[e[20]||(e[20]=t("h3",{class:"text-sm font-medium text-green-600 dark:text-green-400"},"Total Feed Consumed",-1)),t("p",_e,d(D.value.toFixed(2))+" kg",1)]),t("div",ve,[e[21]||(e[21]=t("h3",{class:"text-sm font-medium text-purple-600 dark:text-purple-400"},"Average Daily Feed",-1)),t("p",xe,d(W.value.toFixed(2))+" kg",1)])]),t("div",ce,[t("table",ye,[e[25]||(e[25]=t("thead",{class:"bg-gray-50 dark:bg-gray-800"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Day"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Date"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Feed Amount (kg)"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Notes"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Actions")])],-1)),t("tbody",be,[(k(!0),V(U,null,te(m.value,o=>(k(),V("tr",{key:o.id},[t("td",ke,d(o.day_number),1),t("td",we,d(R(o.consumption_date)),1),t("td",Ce,d(o.feed_amount)+" kg",1),t("td",Ve,d(o.notes||"-"),1),t("td",$e,[t("div",Fe,[a(g,{variant:"outline",size:"sm",onClick:C=>J(o)},{default:n(()=>e[22]||(e[22]=[s("Edit")])),_:2},1032,["onClick"]),a(g,{variant:"destructive",size:"sm",onClick:C=>H(o)},{default:n(()=>e[23]||(e[23]=[s("Delete")])),_:2},1032,["onClick"])])])]))),128)),m.value.length===0?(k(),V("tr",De,e[24]||(e[24]=[t("td",{colspan:"5",class:"px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400"}," No feed consumption records found. Add the first record to get started. ",-1)]))):A("",!0)])])])]),_:1})]),_:1})]),a(B,{open:c.value,"onUpdate:open":e[6]||(e[6]=o=>c.value=o)},{default:n(()=>[a(I,{class:"sm:max-w-md"},{default:n(()=>[a(M,null,{default:n(()=>[a(h,null,{default:n(()=>e[26]||(e[26]=[s("Add Feed Consumption")])),_:1})]),_:1}),t("div",Ee,[t("div",null,[a(i,{for:"day_number"},{default:n(()=>e[27]||(e[27]=[s("Day Number")])),_:1}),a(v,{id:"day_number",modelValue:r.value.day_number,"onUpdate:modelValue":e[1]||(e[1]=o=>r.value.day_number=o),type:"number",min:"1",placeholder:"Enter day number"},null,8,["modelValue"])]),t("div",null,[a(i,{for:"feed_amount"},{default:n(()=>e[28]||(e[28]=[s("Feed Amount (kg)")])),_:1}),a(v,{id:"feed_amount",modelValue:r.value.feed_amount,"onUpdate:modelValue":e[2]||(e[2]=o=>r.value.feed_amount=o),type:"number",step:"0.01",min:"0",placeholder:"Enter feed amount"},null,8,["modelValue"])]),t("div",null,[a(i,{for:"consumption_date"},{default:n(()=>e[29]||(e[29]=[s("Date")])),_:1}),a(v,{id:"consumption_date",modelValue:r.value.consumption_date,"onUpdate:modelValue":e[3]||(e[3]=o=>r.value.consumption_date=o),type:"date"},null,8,["modelValue"])]),t("div",null,[a(i,{for:"notes"},{default:n(()=>e[30]||(e[30]=[s("Notes (Optional)")])),_:1}),a(v,{id:"notes",modelValue:r.value.notes,"onUpdate:modelValue":e[4]||(e[4]=o=>r.value.notes=o),placeholder:"Enter any notes"},null,8,["modelValue"])])]),a(L,null,{default:n(()=>[a(g,{variant:"outline",onClick:e[5]||(e[5]=o=>c.value=!1)},{default:n(()=>e[31]||(e[31]=[s("Cancel")])),_:1}),a(g,{onClick:q,disabled:u.value},{default:n(()=>[s(d(u.value?"Adding...":"Add Consumption"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),a(B,{open:y.value,"onUpdate:open":e[11]||(e[11]=o=>y.value=o)},{default:n(()=>[a(I,{class:"sm:max-w-md"},{default:n(()=>[a(M,null,{default:n(()=>[a(h,null,{default:n(()=>{var o;return[s("Edit Feed Consumption - Day "+d((o=b.value)==null?void 0:o.day_number),1)]}),_:1})]),_:1}),t("div",Ne,[t("div",null,[a(i,{for:"edit_feed_amount"},{default:n(()=>e[32]||(e[32]=[s("Feed Amount (kg)")])),_:1}),a(v,{id:"edit_feed_amount",modelValue:p.value.feed_amount,"onUpdate:modelValue":e[7]||(e[7]=o=>p.value.feed_amount=o),type:"number",step:"0.01",min:"0",placeholder:"Enter feed amount"},null,8,["modelValue"])]),t("div",null,[a(i,{for:"edit_consumption_date"},{default:n(()=>e[33]||(e[33]=[s("Date")])),_:1}),a(v,{id:"edit_consumption_date",modelValue:p.value.consumption_date,"onUpdate:modelValue":e[8]||(e[8]=o=>p.value.consumption_date=o),type:"date"},null,8,["modelValue"])]),t("div",null,[a(i,{for:"edit_notes"},{default:n(()=>e[34]||(e[34]=[s("Notes (Optional)")])),_:1}),a(v,{id:"edit_notes",modelValue:p.value.notes,"onUpdate:modelValue":e[9]||(e[9]=o=>p.value.notes=o),placeholder:"Enter any notes"},null,8,["modelValue"])])]),a(L,null,{default:n(()=>[a(g,{variant:"outline",onClick:e[10]||(e[10]=o=>y.value=!1)},{default:n(()=>e[35]||(e[35]=[s("Cancel")])),_:1}),a(g,{onClick:G,disabled:u.value},{default:n(()=>[s(d(u.value?"Updating...":"Update Consumption"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})],64))}});export{ze as default};
